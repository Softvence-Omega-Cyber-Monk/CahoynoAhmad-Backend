model GameData {
  id                String      @id @default(uuid())
  arabicText        String?
  indonesianText    String?
  audioUrl          String?
  correctArabic     String
  optionsArabic     String[]
  correctEnglish    String
  optionsEnglish    String[]
  correctIndonesian String
  optionsIndonesian String[]
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  surahId           Int?
  ayahId            Int?
  dataType          String?
  duaName           String?
  orderIndex        Int        
  ayah              Ayah?       @relation(fields: [ayahId], references: [id], onDelete: Cascade)
  surah             Surah?      @relation(fields: [surahId], references: [id], onDelete: Cascade)
  dua               Dua?        @relation(fields: [duaName], references: [duaName], onDelete: Cascade)
  userAnswers       UserAnswer[]
}



model UserGameProgress {
  id        String     @id @default(uuid())
  userId    String
  dataType  String     // 'surah' or 'dua'
  surahId   Int?       // nullable for dua
  duaName   String?    // nullable for surah
  score     Int?       @default(0)
  completed Boolean    @default(false)
  playedAt  DateTime   @default(now())

  user      Credential @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, surahId, duaName]) // prevent duplicate progress entries per item
}


model UserAnswer {
  id         String     @id @default(uuid())
  userId     String
  gameId     String
  answeredAt DateTime   @default(now())
  isCorrect  Boolean
  totalAns   Int?
  game       GameData   @relation(fields: [gameId], references: [id],onDelete:Cascade)
  user       Credential @relation(fields: [userId], references: [id],onDelete: Cascade)
}

model Quest {
  id          String      @id @default(uuid())
  title       String
  description String
  xpReward    Int         @default(0)
  type        QuestType   @default(DAILY)
  createdAt   DateTime    @default(now())
  ayahId      Int?
  surahId     Int?
  targetCount Int?
  targetJuz   Int?
  targetSurah Int?
  ayah        Ayah?       @relation(fields: [ayahId], references: [id],onDelete: Cascade)
  surah       Surah?      @relation(fields: [surahId], references: [id],onDelete: Cascade)
  userQuests  UserQuest[]
}

model UserQuest {
  id          String      @id @default(uuid())
  userId      String
  questId     String
  status      QuestStatus @default(IN_PROGRESS)
  assignedAt DateTime @default(now())  
  completedAt DateTime?
  quest       Quest       @relation(fields: [questId], references: [id],onDelete: Cascade)
  user        Credential  @relation(fields: [userId], references: [id],onDelete: Cascade)

  @@unique([userId, questId])
}

enum QuestType {
  DAILY
  WEEKLY
}

enum QuestStatus {
  IN_PROGRESS
  COMPLETED
}
